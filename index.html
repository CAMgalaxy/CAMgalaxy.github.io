<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- for Microsoft Browser? -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- css files: -->
    <link rel="stylesheet" href="./src/css/main.css">
    <link rel="stylesheet" href="./src/css/toastrmin.css">

    <!-- external js libraries: -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"
        integrity="sha512-UNM1njAgOFUa74Z0bADwAq8gbTcqZC8Ej4xPSzpnh0l6KMevwvkBvbldF9uR++qKeJ+MOZHRjV1HZjoRvjDfNQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


    <script src="./src/js/libraries/jquery.js" crossorigin="anonymous"></script>
    <script src="./src/js/libraries/jqueryUI.js" crossorigin="anonymous"></script>
    <script src="./src/js/libraries/toastrmin.js" crossorigin="anonymous"></script>
    <script src="./src/js/libraries/cytoscapemin.js" crossorigin="anonymous"></script>
    <script src="./src/js/libraries/jatos.js" crossorigin="anonymous"></script>

    <!-- own js files: -->
    <script src="./config/configfile.js" crossorigin="anonymous"></script>
    <!-- define CAM object before variable.js -->
    <script src="./src/js/Elements.js" crossorigin="anonymous"></script>
    <script src="./src/js/base64.js" crossorigin="anonymous"></script>
    <script src="./src/js/featureStudies(URLparams).js" crossorigin="anonymous"></script>
    <script src="./src/js/variables.js" crossorigin="anonymous"></script>
    <script src="./src/js/connectorArrows.js" crossorigin="anonymous"></script>

    <script src="./src/js/nodeCAM.js" crossorigin="anonymous"></script>
    <script src="./src/js/connectorCAM.js" crossorigin="anonymous"></script>
    <script src="./src/js/eventListeners_backend.js"></script>
    <script src="./src/js/eventListeners_frontend.js"></script>
    <script src="./src/js/preprocessingCAM.js"></script>
    <script src="./src/js/postprocessingCAM.js"></script>

    <script src="./src/js/paradata_focus.js"></script>

    <title>C.A.M.E.L</title>
    <link rel='shortcut icon' type='image/png' href='./img/favicon_logoCAM2.PNG' />
</head>

<body id="hideall">
    <!-- DIALOGS -->
    <!-- > quick reference -->
    <div id="dialogReference" title="Quick reference">
        <div class="reference">
            <div class="tab">
                <button class="tablinks" onclick="openTab(event, 'QRLegend')">Legend</button>
                <button class="tablinks" onclick="openTab(event, 'QRusingConcepts')">Concept</button>
                <button class="tablinks" onclick="openTab(event, 'QRusingConnections')">Connection</button>
                <button class="tablinks" onclick="openTab(event, 'QRButtons')">Buttons</button>
            </div>
            <!-- interactive component: DEFAULT -->
            <div id="informationDefault" class="tab-defaulttext">
                <i>Please click on the navigation bar if you need help how to draw a Cognitive Affective Map, else you
                    can just close this window.</i>
            </div>

            <div id="QRLegend" class="tabcontent">

                <h3>Every concept is given a basic emotional value:</h3>
                <ul style="list-style-type:none; margin: 0px; padding: 0px;">
                    <li><img src="./img/pos_node.svg#svgView(viewBox(0,5,210,110))" alt=""
                            style="width: 50px; height: 40px; vertical-align:middle;"> Positive concept</li>
                    <li><img src="./img/neg_node.svg#svgView(viewBox(5,5,250,120))" alt=""
                            style="width: 50px; height: 40px; vertical-align:middle;"> Negative concept</li>
                    <li><img src="./img/ambivalent_node.svg#svgView(viewBox(5,5,250,120))" alt=""
                            style="width: 50px; height: 40px; vertical-align:middle;"> Ambivalent concept</li>
                    <li><img src="./img/neutral_node.svg#svgView(viewBox(0,5,180,120))" alt=""
                            style="width: 50px; height: 40px; vertical-align:middle;"> Neutral concept</li>
                    <h3>Draw links between concepts that are related to each other:</h3>
                    <li><img src="./img/solid_lini_mini.svg" alt=""
                            style="width: 50px; height: 40px; vertical-align:middle;"> Concepts support each other
                    </li>
                    <li><img src="./img/dashed_lini_mini.svg" alt=""
                            style="width: 50px; height: 40px; vertical-align:middle;"> Concepts inhibit each other
                    </li>
                    <div id="showCameraFeature">
                        <h3>Move your Cognitive-Affective Map</h3> by moving your cursor to the edge of the drawing
                        window (grey area):
                        <img src="./img/cameraFeature.JPG" alt=""
                            style="width: 260px; height: 120px; vertical-align:text-top;">
                    </div>
                </ul>
            </div>

            <div id="QRusingConcepts" class="tabcontent">
                <h3>Create, update, delete concepts: </h3>
                <ul style="list-style-type:none; margin: 0px; padding: 0px;">
                    <li><b>Create:</b> Single click on blank drawing space</li>
                    <li><b>Update:</b> Double click on existing concept</li>
                    <li><b>Delete:</b> Double click on existing concept and press on the “trash bin” symbol top right.
                    </li>
                </ul>

                <h3>Change content of concepts: </h3>
                <ul style="list-style-type:none; margin: 0px; padding: 0px;">
                    <li><b>Add text:</b> Change the content of the concept (use only single words)</li>
                    <li><b>Change type and strength:</b> Use the slider to change the emotional attribution and strength
                        of the concept</li>
                    <li><b>Add comment:</b> type comment in the “Comment” section</li>
                </ul>
            </div>

            <div id="QRusingConnections" class="tabcontent">
                <h3>Create, update, delete connections: </h3>
                <ul style="list-style-type:none; margin: 0px; padding: 0px;">
                    <li><b>Create:</b> Click on two concepts to draw a connection</li>
                    <li><b>Update:</b> Double click on existing connection</li>
                    <li><b>Delete:</b> Double click on existing concept and press on the “trash bin” symbol top right.
                    </li>
                </ul>

                <h3>Change content of connections: </h3>
                <ul style="list-style-type:none; margin: 0px; padding: 0px;">
                    <li><b>Change type and strength:</b> Use the slider to change the type (agreement or disagreement)
                        and strength of the connection</li>
                    <li style="margin-top: 10px;"><b>Direction of Influence:</b> </li>
                    <li style="padding-left: 10px;"><span style="vertical-align:middle;"
                            class="material-icons">sync_alt</span> Concepts influence each other</li>
                    <li style="padding-left: 10px;"><span style="vertical-align:middle;"
                            class="material-icons">trending_flat</span> Concepts influence each other in a one-sided
                        direction from left to right.</li>
                </ul>
            </div>

            <div id="QRButtons" class="tabcontent">

                <h3>Clicking on the buttons in the upper bar leads to the following results: </h3>
                <ul style="list-style-type:none; margin: 0px; padding: 0px;">
                    <li>
                        <div class="material-icons" style="vertical-align:middle;">save</div> save Cognitive
                        Affective Map and send data to the server
                    </li>
                    <br>
                    <li>
                        <div class="material-icons" style="vertical-align:middle;">crop_original</div> download
                        Cognitive Affective Map as a picture
                    </li>
                    <br>
                    <li>
                        <div class="material-icons" style="color:red; vertical-align:middle;">delete</div> delete
                        Cognitive Affective Map and no data will be send to the server
                    </li>
                </ul>

            </div>
        </div>
    </div>

    <!-- > change connector -->
    <div id="dialogInteractionEdge" title="Change connector:">
        <!-- interactive components: EDGE -->
        <div class="properties" id="interactionEdge">
            <div style="padding-bottom: 30px;">
                <button id="deleteEdge" class="material-icons deleteButton" style="color:red;" title="Delete Connector">
                    delete </button>
            </div>


            <!-- > adjust type and strength of connector -->
            <div class="properties-align">
                <div class="properties-size-naming">
                    Type and Strength of Connection:
                </div>

                <div class="spacing-connector">
                    <span class="redColorTick">Disagreement</span>
                    <span class="greenColorTick">Agreement</span>
                </div>
                <div class="outerConnectorSlider">
                    <div class="greenConnectorColorSlider">
                        <div class="redColorConnectorSlider">
                            <input type="range" min="1" max="6" step="1" value="4" id="edgeSlider" autofocus>
                        </div>
                    </div>
                    <div class="labelsConnectorSlider">
                        <span>-3</span>
                        <span>-2</span>
                        <span>-1</span>
                        <span>1</span>
                        <span>2</span>
                        <span>3</span>
                    </div>
                </div>
            </div>


            <!-- > adjust of connectivity of edge -->
            <div id="hideConnectorDirInfluence">
                <div class="properties-size-naming" style="margin-top: 25px;">
                    Direction of Connection:
                </div>

                <div style="text-align: center;">
                    <div>
                        <button id="bidirectional" type="button" class="material-icons"
                            title="Concepts influence each other" class="connectorButton"
                            style="font-size: 50px;">sync_alt</button>
                        <button id="monodirectional" type="button" class="material-icons"
                            title="Concepts influence each other in a one-sided direction. Press button multiple times to change direction"
                            class="connectorButton" style="font-size: 50px;">trending_flat</button>
                    </div>
                </div>
            </div>
            <!-- for researcher only -->
            <div id="hideResearcherButtonsConnector">
                <div style="margin-top: 20px; font-size:16px; font-style: italic;">
                    The following functions are only available to researchers:
                </div>
                <div>
                    <button id="ResErasabilityConnector" type="button" class="typeResearcherButton">
                        deletable
                    </button>
                </div>
            </div>

        </div>
    </div>



    <!-- > change node -->
    <div id="dialogInteractionNode" title="Change concept:">
        <div class="properties" id="interactionNode">
            <!-- delete node: -->
            <div style="padding-bottom: 30px;">
                <button id="deleteNode" class="material-icons deleteButton" style="color:red;" title="Delete Connector">
                    delete </button>
            </div>

            <!-- > adjust text -->
            <div class="properties-align">
                <div class="properties-size-naming">
                    Content:
                </div>
                <input id="inptextnode" type="text"
                    style="width: 99%; text-align: left;   margin: auto; display: block;" autofocus>
            </div>


            <!-- > adjust type and strength of concept -->
            <div class="properties-align">
                <div class="properties-size-naming">
                    Type and Strength of Concept:
                </div>
            </div>

            <div class="outerNodeSlider">
                <div class="greenColorNodeSlider">
                    <div class="yellowColorNodeSlider">
                        <div class="redColorNodeSlider">
                            <input type="range" min="1" max="7" step="1" id="nodeSlider" list="steplist">
                        </div>
                    </div>
                </div>
                <div class="labelsNodeSlider">
                    <span>-3</span>
                    <span>-2</span>
                    <span>-1</span>
                    <span>0</span>
                    <span>1</span>
                    <span>2</span>
                    <span>3</span>
                </div>
            </div>



            <div class="spacing-node" style="margin-top: 15px;" id="ambivalentNodeShow">

                <input type="checkbox" id="checkboxAmbivalent" style="font-size: 20px;">
                <label for="checkboxAmbivalent" style="font-size: 16px; margin-left: 5px;">set concept to </label>

                <image title="Concept is set to ambivalent" type="image"
                    src="./img/ambivalent_node.svg#svgView(viewBox(5,5,250,120))"
                    style="width: 85px; height: 65px; margin-left: 5px; margin-top: 5px;"></image>

            </div>

            <!-- > adjust comment -->
            <div class="properties-align">
                <div class="properties-size-naming">
                    Comment:
                </div>
                <textarea id="inpcommentnode"
                    style="width: 97%; text-align: left; margin: auto; display: block;"></textarea>
            </div>

            <!-- for researcher only -->
            <div id="hideResearcherButtonsNode">
                <div style="margin-top: 20px; font-size:16px; font-style: italic;">
                    The following functions are only available to researchers:
                </div>
                <div>
                    <button id="ResErasabilityNode" type="button" class="typeResearcherButton">
                        deletable
                    </button>

                    <button id="ResManoeuvrability" type="button" class="typeResearcherButton">
                        movable
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- HEADER -->

    <!-- SVG, components  -->
    <div class="main">
        <div class="boxCAMSVG">
            <div class="cam-header-left">
                <!-- 
                <i class="material-icons">zoom_in</i>
                <i class="material-icons">zoom_out</i>
                <i class="material-icons">fit_screen</i>
                -->
                <div id="hideResearcherButtonsTop">
                    <button id="gen" class="material-icons" title="Test stuff" style="color:blue; margin-left: 10px;">
                        unpublished </button>
                    <button class="material-icons" onclick="onDownloadCAMdata()"
                        title="Save CAM as file">vertical_align_bottom</button>
                    <button class="material-icons" onclick="document.getElementById('fileToLoad').click();"
                        title="Upload CAM from file">vertical_align_top</button>
                    <input type='file' id="fileToLoad" style="display:none">
                </div>
            </div>

            <div class="cam-header-middle">
                <span style="font-weight: bold;">Cognitive-Affective Maps</span>
                <img src="./img/logoCAM2.svg" alt="img Valence logo not found"
                    style="height:1.3rem; width:auto; margin-top: 3px;">
            </div>
            <div class="cam-header-right">
                <button id="quickref" class="material-icons" title="Open a quick reference" style="color:green"> help
                </button>
                <button id="saveCAM" class="material-icons" title="Save CAM"> save </button>
                <button class="material-icons" onclick="onDownloadSVGfile()"
                    title="Save CAM as picture">crop_original</button>

                <button id="deleteCAM" class="material-icons" style="color:red;" title="Delete CAM"> delete </button>
            </div>

            <div class="CAMContainer">
                <svg id="CAMSVG">
                </svg>
            </div>
        </div>
    </div>

    <!-- FOOTER (Copyright) 
    <div class="footerdiv">
        © 2021 Copyright: Florian Gouret &amp; Julius Fenn &amp; ???

    </div>
-->

</body>

<div id="alert" style="background: white; visibility: hidden;" class="content">
    <div id="alert-text" style="text-align: center;">
        <strong>Please do not change or minimize the browser window while the study is running. Only if there is a break
            in the course of the study.</strong>
        <br>
        <button id="alert-button-text" type="button" onclick="document.getElementById('alert').style.visibility = 'hidden'; 
     document.getElementById('hideall').style.visibility = 'visible'; enterFullscreen(); showDialogOnce();">
            click to continue
        </button>
    </div>
</div>


<div id="dialogStart" title="Willkommen zu der Studie!">
    <div class="properties" style="font-size: 16px;">
        Es gelten die folgenden Regeln für die vorliegende <i>Cognitive-Affective Map</i>: 
        <ul  style="font-size: 14px;">
            <li>Zeichnen Sie insgesamt mindestens 20 Konzepte.</li>
            <li>Verwenden Sie pro Konzept nicht mehr als drei Worte.</li>
            <li>Verbinden Sie alle eingezeichneten Konzepte miteinander</li>
        </ul>
        Zoomen Sie bitte soweit raus, dass Sie das gesamte Zeichenfenster der <i>Cognitive-Affective Map</i> sehen können. Sie können dieses Dialogfenster nun schließen und mit dem Zeichnen beginnen. Viel Spaß. 
    </div>
</div>





<script>
        /*
    window.addEventListener('load', (e) => {
        document.getElementById('alert').style.visibility = "visible";
        document.getElementById('hideall').style.visibility = "hidden";
        var lastBlurTimestamp = e.timeStamp;
    });


    window.addEventListener('blur', (e) => {
        document.getElementById('alert').style.visibility = "visible";
        document.getElementById('hideall').style.visibility = "hidden";
        var lastBlurTimestamp = e.timeStamp;
    });

    function enterFullscreen() {
        if (document.documentElement.requestFullscreen) {
            document.documentElement.requestFullscreen();
        } else if (document.documentElement.msRequestFullscreen) { // for IE11 (remove June 15, 2022)
            document.documentElement.msRequestFullscreen();
        } else if (document.documentElement.webkitRequestFullscreen) { // iOS Safari
            document.documentElement.webkitRequestFullscreen();
        }
    }


    var viewFullScreen = document.getElementById("quickref");					

    window.addEventListener("load", function() {
    var docElm = document.documentElement;
    if (docElm.requestFullscreen) {
      docElm.requestFullscreen();
    } else if (docElm.msRequestFullscreen) {
      docElm.msRequestFullscreen();
    } else if (docElm.mozRequestFullScreen) {
      docElm.mozRequestFullScreen();
    } else if (docElm.webkitRequestFullScreen) {
      docElm.webkitRequestFullScreen();
    }
  })
  */

  CAM.addElement(new NodeCAM(0, "Psychologie", {
        x: 650,
        y: 50
    }, false, false, false));

    
    CAM.addElement(new NodeCAM(0, "empfundenen Leistungsdruck", {
        x: 250,
        y: 180
    }, false, false, false));

    
    CAM.addElement(new NodeCAM(0, "allgemeine Lehrklima", {
        x: 650,
        y: 180
    }, false, false, false));

    
    CAM.addElement(new NodeCAM(0, "empfundene Unterstützung", {
        x: 1050,
        y: 180
    }, false, false, false));

    var connector = new ConnectorCAM();
    connector.establishConnection(CAM.nodes[0], CAM.nodes[1], IncreaseSliderIntensity, true);
    CAM.addElement(connector);
    CAM.connectors[0].isBidirectional = false;
    CAM.connectors[0].isDeletable = false; 

    var connector = new ConnectorCAM();
    connector.establishConnection(CAM.nodes[0], CAM.nodes[2], IncreaseSliderIntensity, true);
    CAM.addElement(connector);
    CAM.connectors[1].isBidirectional = false;
    CAM.connectors[1].isDeletable = false; 

    var connector = new ConnectorCAM();
    connector.establishConnection(CAM.nodes[0], CAM.nodes[3], IncreaseSliderIntensity, true);
    CAM.addElement(connector);
    CAM.connectors[2].isBidirectional = false;
    CAM.connectors[2].isDeletable = false; 



    CAM.draw();
</script>

</html>